{% extends "base.html" %}

{% block title %}평가 완료{% endblock %}

{% block content %}
<div class="text-center mb-4">
    <div class="alert alert-success">
        <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
        <h2 class="fw-bold text-success">평가가 성공적으로 저장되었습니다!</h2>
        <p class="lead">팀: <strong>{{ team_name }}</strong></p>
    </div>
</div>

<!-- 평가 결과 요약 -->
<div class="card mb-4">
    <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>평가 결과 요약</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>팀원명</th>
                        <th>의사소통</th>
                        <th>팀워크</th>
                        <th>리더십</th>
                        <th>문제해결</th>
                        <th>책임감</th>
                        <th>총점</th>
                        <th>평균</th>
                    </tr>
                </thead>
                <tbody>
                    {% for eval in evaluations %}
                    <tr>
                        <td><strong>{{ eval.member_name }}</strong></td>
                        <td>{{ eval.communication }}</td>
                        <td>{{ eval.teamwork }}</td>
                        <td>{{ eval.leadership }}</td>
                        <td>{{ eval.problem_solving }}</td>
                        <td>{{ eval.responsibility }}</td>
                        <td><strong>{{ eval.total_score }}</strong></td>
                        <td><strong class="text-primary">{{ eval.average_score }}</strong></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- 통계 정보 -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="stats-card">
            <h3>{{ evaluations|length }}</h3>
            <p>평가된 팀원</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stats-card">
            <h3>{{ "%.1f"|format(evaluations|map(attribute='average_score')|sum / evaluations|length) }}</h3>
            <p>전체 평균</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stats-card">
            <h3>{{ evaluations|map(attribute='total_score')|max }}</h3>
            <p>최고 총점</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stats-card">
            <h3>{{ evaluations|map(attribute='total_score')|min }}</h3>
            <p>최저 총점</p>
        </div>
    </div>
</div>

<!-- 액션 버튼 -->
<div class="text-center">
    <a href="{{ url_for('download', filename=filename) }}" class="btn btn-success btn-lg">
        <i class="fas fa-download me-2"></i>CSV 파일 다운로드
    </a>
    <a href="{{ url_for('view_data') }}" class="btn btn-info btn-lg ms-2">
        <i class="fas fa-chart-bar me-2"></i>전체 데이터 보기
    </a>
    <a href="{{ url_for('evaluate') }}" class="btn btn-primary btn-lg ms-2">
        <i class="fas fa-plus me-2"></i>새로운 평가
    </a>
    <a href="{{ url_for('index') }}" class="btn btn-secondary btn-lg ms-2">
        <i class="fas fa-home me-2"></i>홈으로
    </a>
</div>

<!-- 파일 정보 -->
<div class="mt-4">
    <div class="alert alert-info">
        <h6><i class="fas fa-info-circle me-2"></i>파일 정보</h6>
        <p class="mb-0">
            <strong>파일명:</strong> {{ filename }}<br>
            <strong>저장 위치:</strong> data/ 폴더<br>
            <strong>다음 단계:</strong> 데이터 분석 페이지에서 전체 통계와 차트를 확인할 수 있습니다.
        </p>
    </div>
</div>
{% endblock %} 